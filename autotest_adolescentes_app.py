# -*- coding: utf-8 -*-
"""Copia de AUTOTEST ADOLESCENTES VERSION FINAL.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ayS70KpeZ2NRHPo-825xYRm2-FQCEx-E
"""

import streamlit as st
import matplotlib.pyplot as plt

st.set_page_config(page_title="Autotest Alimentario Adolescente", layout="centered")

st.title("ğŸ Autotest para Adolescentes sobre HÃ¡bitos Alimenticios")
st.write("Este test te ayuda a conocer mejor tu alimentaciÃ³n.")
st.info("âš ï¸ No es un examen. RespondÃ© sinceramente segÃºn tus hÃ¡bitos en el Ãºltimo mes.")

# Diccionarios de preguntas
frecuencia_preguntas = {
    "DesayunÃ¡s": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "AlmorzÃ¡s": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "MerendÃ¡s": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "CenÃ¡s": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Leche, yogur o quesos": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Carnes (vaca, pollo, cerdo, pescado, etc.)": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Verduras": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Frutas": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Pastas, arroz, etc.": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Pan, galletitas": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"],
    "Aceites (con verduras, en purÃ©s, etc.)": ["Ocasionalmente (2 o menos dÃ­as)", "A veces (3 a 4 dÃ­as)", "Casi siempre (5 a 7 dÃ­as)"]
}
frecuencia_valores = {"Ocasionalmente (2 o menos dÃ­as)": 0, "A veces (3 a 4 dÃ­as)": 2, "Casi siempre (5 a 7 dÃ­as)": 5}

frecuencia_inversa_preguntas = {
    "Snacks (papas fritas, chizitos)": 10,
    "Golosinas (caramelos, chocolates)": 5,
    "Gaseosas o jugos artificiales": 5
}
frecuencia_inversa_valores = {"Ocasionalmente (2 o menos dÃ­as)": 10, "A veces (3 a 4 dÃ­as)": 1, "Casi siempre (5 a 7 dÃ­as)": 0}

sino_preguntas = {
    "Â¿TomÃ¡s agua durante el dÃ­a?": 10,
    "Â¿AgregÃ¡s sal sin probar antes?": 10,
    "Â¿ConsumÃ­s mÃ¡s de 2 vasos de alcohol por dÃ­a?": 10,
    "Â¿HacÃ©s actividad fÃ­sica 3 veces por semana?": 10
}
sino_valores = {"SI": 10, "NO": 0}

# RecolecciÃ³n de respuestas
total_score = 0
freq_normal = 0
freq_inverse = 0
sino_total = 0

st.subheader("ğŸ§ª Preguntas de frecuencia semanal")
for pregunta, opciones in frecuencia_preguntas.items():
    respuesta = st.selectbox(pregunta, opciones, key=pregunta)
    puntaje = frecuencia_valores[respuesta]
    freq_normal += puntaje
    total_score += puntaje

st.subheader("ğŸ¥¤ Snacks, golosinas y bebidas azucaradas")
for pregunta, max_puntos in frecuencia_inversa_preguntas.items():
    respuesta = st.selectbox(pregunta, list(frecuencia_inversa_valores.keys()), key=pregunta)
    puntaje = frecuencia_inversa_valores[respuesta]
    freq_inverse += puntaje
    total_score += puntaje

st.subheader("âœ… Preguntas SÃ­ / No")
for pregunta, max_puntos in sino_preguntas.items():
    respuesta = st.radio(pregunta, ["SI", "NO"], key=pregunta)
    if "sal" in pregunta or "alcohol" in pregunta:
        puntaje = 10 if respuesta == "NO" else 0
    else:
        puntaje = 10 if respuesta == "SI" else 0
    sino_total += puntaje
    total_score += puntaje

# Resultado final
st.markdown("---")
st.subheader("ğŸ“Š Resultado del Autotest")

if total_score >= 82:
    clasificacion = "ğŸ¥‡ AlimentaciÃ³n Muy Buena"
    descripcion = "TenÃ©s una alimentaciÃ³n muy buena, Â¡seguÃ­ asÃ­!"
elif 52 <= total_score <= 81:
    clasificacion = "ğŸ¥ˆ AlimentaciÃ³n Buena"
    descripcion = "Tu alimentaciÃ³n es buena, pero puede mejorar."
elif 34 <= total_score <= 51:
    clasificacion = "ğŸ¥‰ AlimentaciÃ³n Regular"
    descripcion = "Tu alimentaciÃ³n es regular. SerÃ­a bueno mejorarla."
else:
    clasificacion = "âš ï¸ NecesitÃ¡s mejorar tu alimentaciÃ³n"
    descripcion = "SerÃ­a importante revisar tus hÃ¡bitos con un/a nutricionista."

st.success(f"**Tu clasificaciÃ³n es:** {clasificacion}")
st.write(f"**DescripciÃ³n:** {descripcion}")
st.write(f"**Puntaje total:** {total_score}")

# GrÃ¡fico de barras tipo semÃ¡foro
st.subheader("ğŸ“ˆ GrÃ¡fico de tus resultados por categorÃ­a")

categorias = ["Comidas Frecuentes", "Snacks/Bebidas", "HÃ¡bitos Generales"]
puntajes = [freq_normal, freq_inverse, sino_total]

colores = []
minimo = min(puntajes)
maximo = max(puntajes)

for p in puntajes:
    if p == minimo:
        colores.append("red")
    elif p == maximo:
        colores.append("green")
    else:
        colores.append("gold")

fig, ax = plt.subplots()
bars = ax.bar(categorias, puntajes, color=colores)
ax.set_ylabel("Puntaje")
ax.set_ylim(0, max(puntajes) + 10)
ax.set_title("Desglose de Puntaje por CategorÃ­a")

# Mostrar valores sobre cada barra
for bar in bars:
    yval = bar.get_height()
    ax.text(bar.get_x() + bar.get_width()/2, yval + 1, str(yval), ha='center', va='bottom')

st.pyplot(fig)

st.markdown("---")
st.info("ğŸ§  RecomendaciÃ³n: ConsultÃ¡ siempre a un profesional de la salud para orientaciÃ³n personalizada.")